#lang racket

(require json
         racket/trace)


(define j
"[{\"codigo\":\"BIK0102-13\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Estrutura da Matéria\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIR0004-13\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Bases Epistemológicas da Ciência Moderna\",\"categoria\":\"Obrigatória\"}]"
)


(define j2
"[{\"codigo\":\"BIK0102-13\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Estrutura da Matéria\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIR0004-13\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Bases Epistemológicas da Ciência Moderna\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCS0001-13\",\"creditos\":3,\"periodo\":\"2\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Base Experimental das Ciências Naturais\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIL0304-13\",\"creditos\":3,\"periodo\":\"2\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Origem da Vida e Diversidade dos Seres Vivos\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIM0005-13\",\"creditos\":2,\"periodo\":\"2\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Bases Computacionais da Ciência\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIN0003-13\",\"creditos\":4,\"periodo\":\"2\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Bases Matemáticas\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"MCZC003-13\",\"creditos\":4,\"periodo\":\"2\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Introdução à Psicolinguística\",\"categoria\":\"Livre Escolha\"},{\"codigo\":\"BCJ0208-13\",\"creditos\":5,\"periodo\":\"3\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Fenômenos Mecânicos\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCL0306-13\",\"creditos\":3,\"periodo\":\"3\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Transformações nos Seres Vivos e Ambiente\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCM0504-13\",\"creditos\":3,\"periodo\":\"3\",\"conceito\":\"F\",\"situacao\":\"Reprovado\",\"ano\":2013,\"disciplina\":\"Natureza da Informação\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCN0402-13\",\"creditos\":4,\"periodo\":\"3\",\"conceito\":\"F\",\"situacao\":\"Reprovado\",\"ano\":2013,\"disciplina\":\"Funções de Uma Variável\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCN0404-13\",\"creditos\":3,\"periodo\":\"3\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2013,\"disciplina\":\"Geometria Analítica\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCJ0205-13\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"F\",\"situacao\":\"Reprovado\",\"ano\":2014,\"disciplina\":\"Fenômenos Térmicos\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCL0307-13\",\"creditos\":5,\"periodo\":\"1\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Transformações Químicas\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCM0506-13\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Comunicação e Redes\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCN0405-13\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"F\",\"situacao\":\"Reprovado\",\"ano\":2014,\"disciplina\":\"Introdução às Equações Diferenciais Ordinárias\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCM0505-13\",\"creditos\":5,\"periodo\":\"2\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Processamento da Informação\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCN0402-13\",\"creditos\":4,\"periodo\":\"2\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Funções de Uma Variável\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIQ0602-13\",\"creditos\":3,\"periodo\":\"2\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Estrutura e Dinâmica Social\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIR0603-13\",\"creditos\":3,\"periodo\":\"2\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Ciência, Tecnologia e Sociedade\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"NHZ4033-09\",\"creditos\":4,\"periodo\":\"2\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Práticas de Química Verde\",\"categoria\":\"Livre Escolha\"},{\"codigo\":\"BCN0407-13\",\"creditos\":4,\"periodo\":\"3\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2014,\"disciplina\":\"Funções de Várias Variáveis\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIJ0207-13\",\"creditos\":2,\"periodo\":\"3\",\"conceito\":\"O\",\"situacao\":\"Repr.Freq\",\"ano\":2014,\"disciplina\":\"Energia: Origens, Conversão e Uso\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIN0406-13\",\"creditos\":3,\"periodo\":\"3\",\"conceito\":\"F\",\"situacao\":\"Reprovado\",\"ano\":2014,\"disciplina\":\"Introdução à Probabilidade e à Estatística\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCJ0205-13\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Fenômenos Térmicos\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"ESTO002-13\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Engenharia Econômica\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"ESTO008-13\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Mecânica dos Sólidos I\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"MCTA009-13\",\"creditos\":2,\"periodo\":\"1\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Computadores, Ética e Sociedade\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"BCM0505-13\",\"creditos\":5,\"periodo\":\"2\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Processamento da Informação\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCN0405-13\",\"creditos\":4,\"periodo\":\"2\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Introdução às Equações Diferenciais Ordinárias\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIN0406-13\",\"creditos\":3,\"periodo\":\"2\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Introdução à Probabilidade e à Estatística\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"ESTO005-13\",\"creditos\":2,\"periodo\":\"2\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Introdução às Engenharias\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"ESZI003-13\",\"creditos\":4,\"periodo\":\"2\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Processamento de Informação em Línguas Naturais\",\"categoria\":\"Livre Escolha\"},{\"codigo\":\"BCL0308-13\",\"creditos\":5,\"periodo\":\"3\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Transformações Bioquímicas\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"MCTA006-13\",\"creditos\":4,\"periodo\":\"3\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Circuitos Digitais\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"MCTA018-13\",\"creditos\":4,\"periodo\":\"3\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2015,\"disciplina\":\"Programação Orientada a Objetos\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"BCK0103-15\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"F\",\"situacao\":\"Reprovado\",\"ano\":2016,\"disciplina\":\"Física Quântica\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BIJ0207-15\",\"creditos\":2,\"periodo\":\"1\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2016,\"disciplina\":\"Bases Conceituais da Energia\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"MCTA001-13\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2016,\"disciplina\":\"Algoritmos e Estruturas de Dados I\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"MCTB009-13\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2016,\"disciplina\":\"Cálculo Numérico\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"TRT\",\"creditos\":0,\"periodo\":\"2\",\"conceito\":\"-\",\"situacao\":\"Trt. Total\",\"ano\":2016,\"disciplina\":\"TRANCAMENTO TOTAL\",\"categoria\":\"-\"},{\"codigo\":\"TRT\",\"creditos\":0,\"periodo\":\"3\",\"conceito\":\"-\",\"situacao\":\"Trt. Total\",\"ano\":2016,\"disciplina\":\"TRANCAMENTO TOTAL\",\"categoria\":\"-\"},{\"codigo\":\"TRT\",\"creditos\":0,\"periodo\":\"1\",\"conceito\":\"-\",\"situacao\":\"Trt. Total\",\"ano\":2017,\"disciplina\":\"TRANCAMENTO TOTAL\",\"categoria\":\"-\"},{\"codigo\":\"TRT\",\"creditos\":0,\"periodo\":\"2\",\"conceito\":\"-\",\"situacao\":\"Trt. Total\",\"ano\":2017,\"disciplina\":\"TRANCAMENTO TOTAL\",\"categoria\":\"-\"},{\"codigo\":\"BCK0103-15\",\"creditos\":3,\"periodo\":\"3\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2017,\"disciplina\":\"Física Quântica\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCM0504-15\",\"creditos\":3,\"periodo\":\"3\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2017,\"disciplina\":\"Natureza da Informação\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"BCS0002-15\",\"creditos\":2,\"periodo\":\"3\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2017,\"disciplina\":\"Projeto Dirigido\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"ESZI027-17\",\"creditos\":2,\"periodo\":\"3\",\"conceito\":\"A\",\"situacao\":\"Aprovado\",\"ano\":2017,\"disciplina\":\"Informação e Sociedade\",\"categoria\":\"Livre Escolha\"},{\"codigo\":\"MCTA002-17\",\"creditos\":4,\"periodo\":\"3\",\"conceito\":\"B\",\"situacao\":\"Aprovado\",\"ano\":2017,\"disciplina\":\"Algoritmos e Estruturas de Dados II\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"BCK0104-15\",\"creditos\":3,\"periodo\":\"1\",\"conceito\":\"D\",\"situacao\":\"Aprovado\",\"ano\":2018,\"disciplina\":\"Interações Atômicas e Moleculares\",\"categoria\":\"Obrigatória\"},{\"codigo\":\"MCTA023-17\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2018,\"disciplina\":\"Segurança de Dados\",\"categoria\":\"Opção Limitada\"},{\"codigo\":\"MCTA033-15\",\"creditos\":4,\"periodo\":\"1\",\"conceito\":\"C\",\"situacao\":\"Aprovado\",\"ano\":2018,\"disciplina\":\"Engenharia de Software\",\"categoria\":\"Opção Limitada\"}]"
  )


(define a 
(string->jsexpr j2))

(define (passed-class? grade)
  (if (or (equal? "A" grade)
          (equal? "B" grade)
          (equal? "C" grade)
          (equal? "D" grade)) #t #f))



;criar lista de cursos que passou
(define make-course-list
  (let loop ([l a] [r '()])
    (cond [(null? l) r]
          [(passed-class? (hash-ref (car l) 'conceito ""))
           (loop (cdr l) (append r (list (hash-ref (car l) 'codigo ""))))]
          [else (loop (cdr l) r)])))


